/*
 * generated by Xtext 2.37.0
 */
package fr.enseeiht.ocl.xtext.ui.outline;

import org.eclipse.emf.ecore.EObject;
import org.eclipse.xtext.ui.editor.outline.IOutlineNode;
import org.eclipse.xtext.ui.editor.outline.impl.DefaultOutlineTreeProvider;

import fr.enseeiht.ocl.xtext.ocl.IntegerLiteralExp;
import fr.enseeiht.ocl.xtext.ocl.NotOpCallExp;
import fr.enseeiht.ocl.xtext.ocl.PropertyCallExp;

/**
 * Customization of the default outline structure.
 *
 * See https://www.eclipse.org/Xtext/documentation/310_eclipse_support.html#outline
 */
public class OclOutlineTreeProvider extends DefaultOutlineTreeProvider {

	
	
	@Override
	protected void _createChildren(IOutlineNode parentNode, EObject modelElement) {
		for (EObject child : modelElement.eContents()) {
			if(child.eClass().getEStructuralFeature("argumentGauche") != null) {
				while ((!(child instanceof NotOpCallExp)) && child.eGet(child.eClass().getEStructuralFeature("operationName")) == null) {
					child = (EObject) child.eGet(child.eClass().getEStructuralFeature("argumentGauche"));
				}
			}
			if((child instanceof PropertyCallExp pce) && pce.getCalls().isEmpty()) {
				child = pce.getSource();
			}
			_createNode(parentNode, child);
		}
	}

	@Override
	protected Object _text(Object modelElement) {
		// TODO Auto-generated method stub
		if(modelElement instanceof IntegerLiteralExp ile)
			return String.valueOf(ile.getIntegerSymbol());
//		if(super._text(modelElement) == null) {
//			return "temppp";
//		}
		return super._text(modelElement);
	}

	
	
}
